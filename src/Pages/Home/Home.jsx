import React from "react";
import { NavLink } from "react-router-dom";
// <<< ุชุฃูุฏ ูู ุงููุณุงุฑ ุงูุตุญูุญ ููููู
import { useHomeData } from "../../hooks/useHomeData.jsx";

// --- ูููุจูููุชุณ ุงูุฃูุณุงู (ูุคูุชุงู ููุงุ ูููู ูููููู ููููุงุช ูููุตูุฉ ุจุนุฏูู) ---

// 1. Hero Section (ุชุณุชูุจู ูู ุจูุงูุงุชูุง ูู props)
const HeroSection = ({ sectionData }) => {
  // ุจูุงูุงุช ุซุงุจุชุฉ ูุคูุชุฉ ูู ุงูู API ูุฑุฌุนุด items (ุงุญุชูุงุทู)
  const defaultFeatureCards = [
    { icon: "๐", title: "ุงุฎุชุจุงุฑุงุช ุชูุงุนููุฉ", subtitle: "ุฃูุซุฑ ูู 5000 ุณุคุงู" },
    { icon: "๐", title: "ูุนูููู ุฎุจุฑุงุก", subtitle: "ุฎุจุฑุฉ ุฃูุซุฑ ูู 10 ุณููุงุช" },
    { icon: "๐จโ๐ซ", title: "ุชุฏุฑูุจ ููุซู", subtitle: "ูุชุงุจุนุฉ ููููุฉ ูุณุชูุฑุฉ" },
  ];
  const defaultStatsData = [
    { number: "150+", text: "ุฏูุฑุฉ ุชุฏุฑูุจูุฉ" },
    { number: "98%", text: "ูุณุจุฉ ุงููุฌุงุญ" },
    { number: "10K+", text: "ุทุงูุจ ุดุบูู" },
  ];

  // ุงุณุชุฎุฏุงู ุจูุงูุงุช ุงูู API ูู ููุฌูุฏุฉุ ูุฅูุง ูุณุชุฎุฏู ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ
  // ุงูู API ุจุชุงุน ุงูู Hero ูุด ุจูุฑุฌุน items ุญุงููุงูุ ููุณุชุฎุฏู title/subtitle/description ุจุณ
  const title = sectionData?.title || "ุฃููุงู ุจูู ูู ููุตุฉ ุงููุฆุฉ ุงูุชุนููููุฉ";
  const subtitle = sectionData?.subtitle || "โจ ุงูุฃูุถู ูู ุงูููููุฉ";
  const description =
    sectionData?.description || "ุงูุถู ูุฃูุซุฑ ูู 10,000 ุทุงูุจ...";
  const featureCards = sectionData?.items?.featureCards || defaultFeatureCards; // ุงูุชุฑุงุถ ูู ุงูู API ููุฑุฌุน items ูุฏู
  const statsData = sectionData?.items?.statsData || defaultStatsData; // ุงูุชุฑุงุถ ูู ุงูู API ููุฑุฌุน items ูุฏู

  return (
    <div className="bg-gradient-to-tl from-purple-300 to-purple-600 text-white pt-28 pb-20">
      <div className="container mx-auto px-4">
        <div className="flex flex-col lg:flex-row items-center justify-between gap-12 ">
          {/* Right Side */}
          <div className="w-full lg:w-6/12 text-center lg:text-right">
            <span className=" bg-primary text-white border border-white/20 font-bold px-6 py-3 rounded-full text-sm inline-block mb-4">
              {subtitle}
            </span>
            <h1 className="text-4xl md:text-6xl font-black my-6 leading-tight ">
              {/* ูููู ููุณู ุงูุนููุงู ูู ููู \n */}
              {title.split("\n").map((line, i) => (
                <React.Fragment key={i}>
                  {line}
                  <br />
                </React.Fragment>
              ))}
            </h1>
            <span className="text-yellow-300 text-3xl font-bold mb-4 inline-block">
              ุชุฃุณูุณ ูู ุงูุจุฏุงูุฉ ูุชุฏุฑูุจ ุญุชู ุงูุฅุชูุงู. {/* (ูุต ุซุงุจุช ูู ุงูุฏูุฒุงูู) */}
            </span>
            <p className="text-lg text-white/80 mb-8 whitespace-pre-line">
              {description}
            </p>
            {/* Buttons */}
            <div className="grid grid-cols-2 gap-4">
              <NavLink to="/register" className="w-full">
                <button className="bg-gradient-to-l from-purple-600 to-purple-500 text-white font-bold px-6 py-4 rounded-lg flex items-center justify-center gap-2 hover:shadow-xl hover:from-purple-700 hover:to-purple-600 hover:scale-105 transition-all duration-300 w-full">
                  <span>๐ค</span> <span>ุงูุชุณุฌูู ุจุงููููุน</span>
                </button>
              </NavLink>
              <button className="bg-yellow-400 text-gray-900 font-bold px-6 py-4 rounded-lg flex items-center justify-center gap-2 hover:shadow-xl hover:bg-yellow-500 hover:scale-105 transition-all duration-300">
                <span>๐</span> <span>ุงูุนุฑูุถ ุงูุฎุงุตุฉ</span>
              </button>
              <button className="bg-white/20 bg-opacity-20 border-2 border-white/40 text-white font-bold px-6 py-4 rounded-lg flex items-center justify-center gap-2 hover:bg-white/20 transition-all duration-300 hover:bg-opacity-30">
                <span>๐</span> <span>ุฃูุดุฆ ุฎุทุชู</span>
              </button>
              <button className="bg-gradient-to-l from-purple-500 to-purple-400 text-white font-bold px-8 py-4 rounded-xl flex items-center justify-center gap-3 shadow-xl hover:scale-105 transition-all duration-300 ">
                <span>๐ฏ</span> <span>ุญุฏุฏ ูุณุชูุงู</span>
              </button>
            </div>
            {/* Stats */}
            <div className="mt-20 flex justify-around items-center text-center divv relative">
              {statsData.map((stat, index) => (
                <div key={index}>
                  <p className="text-5xl font-bold text-yellow-300">
                    {stat.number}
                  </p>
                  <p className="text-white/80 mt-2">{stat.text}</p>
                </div>
              ))}
            </div>
          </div>
          {/* Left Side: Feature Cards */}
          <div className="w-full lg:w-5/12 grid grid-cols-1 gap-5">
            {/* ูุนุฑุถ ุงูู featureCards */}
            {featureCards.map((card, index) => (
              <div
                key={index}
                className="bg-white/20 backdrop-blur-md border border-white/20 rounded-2xl px-10 py-7 flex items-center gap-5 hover:border-white/40 transition-all hover:scale-105 duration-300 justify-between"
              >
                <div>
                  <h3 className="font-bold text-2xl">{card.title}</h3>
                  <p className="text-white/80 mt-2 font-semibold">
                    {card.subtitle}
                  </p>
                </div>
                <div className="bg-gradient-to-br from-purple-600 to-indigo-600 p-4 rounded-lg text-white shadow-lg ">
                  <span className="text-2xl">{card.icon}</span>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
};

// 2. Categories Section (ุชุณุชูุจู items ูู props)
const CategoriesSection = ({ sectionData }) => {
  const title = sectionData?.title || "ุงูุฃูุณุงู";
  const description = sectionData?.description || "ุงุฎุชุฑ ุงููุณุงุฑ ุงูููุงุณุจ ูู";
  // ููุชุฑุถ ุฃู ุงูู API ุจูุฑุฌุน ุงูู items ุจุงูุดูู ุฏู: [{ name: "ูุฏุฑุงุช", icon: "๐", ... }, ...]
  const categories = sectionData?.items || [];

  return (
    <section className="py-20 bg-white">
      <div className="container mx-auto px-4 text-center">
        <h2 className="text-5xl font-extrabold text-gray-800 mb-4">{title}</h2>
        <p className="text-lg text-gray-500 mb-12">{description}</p>
        {/* ูุนุฑุถ ุงูู categories ุงููู ุฌุงูุฉ ูู ุงูู API */}
        <div className="grid grid-cols-2 md:grid-cols-5 gap-6">
          {categories.length > 0 ? (
            categories.map((cat, index) => (
              <div
                key={index}
                className="bg-white p-8 rounded-2xl shadow-sm hover:shadow-xl hover:-translate-y-2 transition-all cursor-pointer border border-gray-100 duration-300 "
              >
                <div className="flex justify-center mb-5 h-12 items-center">
                  {/* ูููู ูุนุฑุถ icon ูู ุงูู API ุจูุฑุฌุนูุ ุฃู ูุณุชุฎุฏู emoji */}
                  <span className="text-4xl font-extrabold text-gray-700">
                    {cat.icon || "๐"} {/* Icon from API or fallback */}
                  </span>
                </div>
                <h3 className="font-semibold text-xl text-gray-700">
                  {cat.name}
                </h3>
                {/* ูููู ูุถูู description ูู ุงูู API ุจูุฑุฌุนู */}
                {/* <p className="text-sm text-gray-500 mt-1">{cat.description}</p> */}
              </div>
            ))
          ) : (
            <p className="col-span-full text-gray-500">
              ูุง ุชูุฌุฏ ุฃูุณุงู ูุนุฑุถูุง ุญุงููุงู.
            </p>
          )}
        </div>
      </div>
    </section>
  );
};

// 3. Features Section (ุชุณุชูุจู items ูู props)
const FeaturesSection = ({ sectionData }) => {
  const title = sectionData?.title || "ูููุฒุงุช ุงูููุตุฉ";
  const description = sectionData?.description || "";
  // ููุชุฑุถ ุฃู ุงูู API ุจูุฑุฌุน ุงูู items ุจุงูุดูู ุฏู: [{ title: "ุชุฃุณูุณ", subtitle: "ูู ุงูุจุฏุงูุฉ", icon: "๐", ... }, ...]
  const features = sectionData?.items || [];

  return (
    <section className="py-20 bg-gray-50">
      <div className="container mx-auto px-4 text-center">
        <h2 className="text-5xl font-extrabold text-gray-800 mb-4">{title}</h2>
        <p className="text-lg text-gray-500 mb-12">{description}</p>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          {features.length > 0 ? (
            features.map((feature, index) => (
              <div
                key={index}
                className="bg-purple-600 text-white p-10 rounded-2xl flex flex-col items-center justify-center transition-all duration-300 hover:-translate-y-2 hover:shadow-xl cursor-pointer "
              >
                <div className="mb-5 text-yellow-500">
                  <span className="text-5xl">{feature.icon || "โญ"}</span>{" "}
                  {/* Icon or fallback */}
                </div>
                <h3 className="font-bold text-2xl mb-1">{feature.title}</h3>
                <p className="text-white/80 text-base">{feature.subtitle}</p>
              </div>
            ))
          ) : (
            <p className="col-span-full text-gray-500">
              ูุง ุชูุฌุฏ ูููุฒุงุช ูุนุฑุถูุง ุญุงููุงู.
            </p>
          )}
        </div>
      </div>
    </section>
  );
};

// --- ุจุงูู ุงูุณูุงุดู (Packages, Testimonials, Partners) ---
// ููุนุฏููู ุจููุณ ุงูุทุฑููุฉ: ุงุณุชูุจุงู sectionData ูุงุณุชุฎุฏุงู items ูููุง

const PackagesSection = ({ sectionData }) => {
  const title = sectionData?.title || "ุงูุจุงูุงุช ุงูุฎุงุตุฉ";
  const description = sectionData?.description || "";
  const packages = sectionData?.items || [];

  return (
    <section className="py-20 bg-white">
      <div className="container mx-auto px-4 text-center">
        <p className="text-lg text-gray-500 mb-12">{description}</p>
        <div className="mb-12">
          <button className="bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold py-3 px-8 rounded-xl shadow-lg flex items-center gap-2 mx-auto mb-10">
            <span>๐</span> <span className="text-3xl">{title}</span>
          </button>
        </div>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
          {packages.length > 0 ? (
            packages.map((pkg, index) => (
              <div
                key={index}
                className="bg-white p-10 rounded-3xl shadow-xl text-center flex flex-col items-center transition-all duration-300 hover:scale-105"
              >
                <div className="text-amber-600 mb-6">
                  <span className="text-6xl">{pkg.icon || "๐ฆ"}</span>
                </div>
                <h3 className="font-bold text-2xl mb-3 text-gray-800">
                  {pkg.title}
                </h3>
                <p className="text-gray-500 mb-8">{pkg.description}</p>
                <button className="w-full bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-semibold py-3 rounded-lg mt-auto flex items-center justify-center gap-2 transition-all duration-300 hover:shadow-lg hover:brightness-110 hover:scale-105 ">
                  <span>โก๏ธ</span>{" "}
                  <span>{pkg.button_text || "ุงุดุชุฑู ุงูุขู"}</span>
                </button>
              </div>
            ))
          ) : (
            <p className="col-span-full text-gray-500">
              ูุง ุชูุฌุฏ ุจุงูุงุช ูุนุฑุถูุง ุญุงููุงู.
            </p>
          )}
        </div>
      </div>
    </section>
  );
};

const TestimonialsSection = ({ sectionData }) => {
  const title = sectionData?.title || "ุขุฑุงุก ุงูุทูุงุจ";
  const description = sectionData?.description || "ูุงุฐุง ูููู ุทูุงุจูุง ุนูุงุ";
  const testimonials = sectionData?.items || [];

  return (
    <section className="py-20 bg-gray-50">
      <div className="container mx-auto px-4 text-center">
        <h2 className="text-5xl font-extrabold text-gray-800 mb-4">{title}</h2>
        <p className="text-lg text-gray-500 mb-12">{description}</p>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
          {testimonials.length > 0 ? (
            testimonials.map((testimonial, index) => (
              <div
                key={index}
                className="bg-white p-8 rounded-2xl shadow-lg transition-all duration-300 hover:scale-105 cursor-pointer "
              >
                <div className="flex justify-center text-yellow-500 mb-8">
                  <span className="text-3xl">
                    {"โญ".repeat(testimonial.rating || 5)}
                  </span>
                </div>
                <p className="text-gray-600 text-center mb-6 text-base leading-relaxed font-semibold ">
                  {testimonial.comment}
                </p>
                <div className="flex items-center mt-6">
                  <div className="bg-purple-600 p-3 rounded-full shadow-md text-gray-700">
                    {/* ูููู ูุณุชุฎุฏู ุตูุฑุฉ ูู ุงูู API ุจูุฑุฌุนูุง */}
                    {/* <img src={testimonial.avatar} alt={testimonial.name} className="w-8 h-8 rounded-full" /> */}
                    <span className="text-xl">๐ค</span>
                  </div>
                  <div className="mr-3">
                    <p className="font-bold text-gray-800">
                      {testimonial.name}
                    </p>
                    <span className="text-sm text-gray-500 px-3 py-1 rounded-md font-medium">
                      {testimonial.course}
                    </span>
                  </div>
                </div>
              </div>
            ))
          ) : (
            <p className="col-span-full text-gray-500">
              ูุง ุชูุฌุฏ ุขุฑุงุก ูุนุฑุถูุง ุญุงููุงู.
            </p>
          )}
        </div>
      </div>
    </section>
  );
};

const PartnersSection = ({ sectionData }) => {
  const title = sectionData?.title || "ุดุฑูุงุก ุงููุฌุงุญ";
  const description =
    sectionData?.description || "ููุฎุฑ ุจุซูุฉ ุนููุงุฆูุง ูุดุฑูุงุฆูุง...";
  const partners = sectionData?.items || [];

  // ุจูุงูุงุช ุงูุชุฑุงุถูุฉ ูู ุงูู API ูุฑุฌุนุด items
  const defaultPartnersData = [
    { id: 4, icon: "๐ข", bgColor: "white" },
    { id: 3, icon: "๐๏ธ", bgColor: "purple" },
    { id: 2, icon: "๐", bgColor: "white" },
    { id: 1, icon: "๐ค", bgColor: "purple" },
  ];
  const partnersToDisplay =
    partners.length > 0 ? partners : defaultPartnersData;

  return (
    <section className="py-20 bg-white">
      <div className="container mx-auto px-4 text-center">
        <h2 className="text-5xl font-extrabold text-gray-800 mb-4">{title}</h2>
        <p className="text-lg text-gray-500 mb-12">{description}</p>
        <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
          {partnersToDisplay.map((partner) => (
            <div
              key={partner.id || partner.icon} // ุงุณุชุฎุฏุงู icon ูููุชุงุญ ุงุญุชูุงุทู
              className={`p-12 rounded-3xl shadow-lg flex justify-center items-center
                                         transition-all duration-300 hover:scale-105 cursor-pointer
                                         ${
                                           partner.bgColor === "purple"
                                             ? "bg-purple-600"
                                             : "bg-white"
                                         }`}
            >
              {/* ูููู ูุณุชุฎุฏู ุตูุฑุฉ ูู ุงูู API ุจูุฑุฌุน logo_url */}
              {/* <img src={partner.logo_url} alt="Partner Logo" className="h-16 object-contain" /> */}
              <span className="text-6xl">{partner.icon}</span>
            </div>
          ))}
          {partnersToDisplay.length === 0 && (
            <p className="col-span-full text-gray-500">
              ูุง ููุฌุฏ ุดุฑูุงุก ูุนุฑุถูู ุญุงููุงู.
            </p>
          )}
        </div>
      </div>
    </section>
  );
};
// -------------------------------------------------------------------

// --- ุงููููุจูููุช ุงูุฃุณุงุณู ูุตูุญุฉ ุงูููู ---
export default function Home() {
  // <<< ุงุณุชุฎุฏุงู ุงูููู ูุฌูุจ ุงูุจูุงูุงุช ุงูุชูุตูููุฉ
  const { detailedSections, isLoading, error, isError } = useHomeData();

  // <<< ุญุงูุฉ ุงูู Loading
  if (isLoading) {
    return (
      <div className="flex justify-center items-center min-h-[calc(100vh-200px)]">
        <svg className="animate-spin h-10 w-10 text-purple-600" /*...*/></svg>
        <p className="text-xl font-semibold ml-4">
          ุฌุงุฑู ุชุญููู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ...
        </p>
      </div>
    );
  }

  // <<< ุญุงูุฉ ุงูู Error
  if (isError) {
    console.error("Home Page API Error:", error);
    return (
      <div className="flex flex-col justify-center items-center min-h-[calc(100vh-200px)] text-center px-4">
        <p className="text-2xl text-red-600 font-bold mb-4">๐ ุญุฏุซ ุฎุทุฃ</p>
        <p className="text-lg text-gray-700 mb-2">
          ุนุฐุฑุงูุ ูู ูุชููู ูู ุชุญููู ุจูุงูุงุช ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ.
        </p>
        <p className="text-sm text-gray-500">
          ({error?.message || "ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ูุงุญูุงู"})
        </p>
      </div>
    );
  }

  // <<< ูู ุงูุจูุงูุงุช ูุตูุช ุจูุฌุงุญ
  // Function to find detailed section data by key
  const getSectionData = (key) =>
    detailedSections?.find((section) => section.key === key);

  // Check if detailed sections data is available before rendering
  if (!detailedSections || detailedSections.length === 0) {
    return (
      <div className="flex flex-col justify-center items-center min-h-[calc(100vh-200px)] text-center px-4">
        <p className="text-xl text-gray-700 font-semibold">
          ูุง ุชูุฌุฏ ุจูุงูุงุช ูุนุฑุถูุง ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุญุงููุงู.
        </p>
      </div>
    );
  }

  console.log("Rendering Home with detailed sections:", detailedSections);

  // --- Mapping Keys to Components ---
  // ุฏู ุจูุฎูููุง ูุนุฑุถ ุงูุณูุงุดู ุจุงูุชุฑุชูุจ ุงููู ุฌุงู ูู ุงูู API ุงูุฃูู (ูู ุญุจููุง)
  // ุฃู ูููู ูุฑุตูู ุจุงูุชุฑุชูุจ ุงููู ุนุงูุฒููู ุฒู ูุง ุนูููุง ุชุญุช
  // eslint-disable-next-line no-unused-vars
  const sectionComponentMap = {
    hero: HeroSection,
    categories: CategoriesSection,
    features: FeaturesSection,
    packages: PackagesSection,
    testimonials: TestimonialsSection,
    partners: PartnersSection,
    // ... ูุถูู ุฃู keys ุชุงููุฉ ูู ููุฌูุฏุฉ
  };
  // ---------------------------------

  return (
    <>
      {/* ููุนุฑุถ ุงูุณูุงุดู ุจุงูุชุฑุชูุจ ุงููู ุนุงูุฒููู */}
      {/* ููุชุฃูุฏ ุฅู ุงูุณูุดู ููุฌูุฏ ูุจู ูุง ูุญุงูู ูุนุฑุถ ุงููููุจูููุช ุจุชุงุนู */}
      {getSectionData("hero") && (
        <HeroSection sectionData={getSectionData("hero")} />
      )}
      {getSectionData("categories") && (
        <CategoriesSection sectionData={getSectionData("categories")} />
      )}
      {getSectionData("features") && (
        <FeaturesSection sectionData={getSectionData("features")} />
      )}
      {getSectionData("packages") && (
        <PackagesSection sectionData={getSectionData("packages")} />
      )}
      {getSectionData("testimonials") && (
        <TestimonialsSection sectionData={getSectionData("testimonials")} />
      )}
      {getSectionData("partners") && (
        <PartnersSection sectionData={getSectionData("partners")} />
      )}

      {/* // ุทุฑููุฉ ุชุงููุฉ ูุนุฑุถ ุงูุณูุงุดู ุจุงูุชุฑุชูุจ ุงููู ุฌุงู ูู ุงูู API
        detailedSections.map(section => {
          const SectionComponent = sectionComponentMap[section.key];
          return SectionComponent ? <SectionComponent key={section.key} sectionData={section} /> : null;
        }) 
      */}
    </>
  );
}
// -------------------------------------------------------------------
